{"ast":null,"code":"import axios from 'axios';\nconst axiosInstance = axios.create({\n  baseURL: 'http://localhost:8080/api',\n  withCredentials: true\n});\naxiosInstance.interceptors.request.use(config => {\n  const token = localStorage.getItem('accessToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => Promise.reject(error));\naxiosInstance.interceptors.response.use(response => response, async error => {\n  const originalRequest = error.config;\n  if (error.response.status === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    try {\n      const response = await axiosInstance.post('/refresh-token', {\n        refreshToken: localStorage.getItem('refreshToken')\n      });\n      const {\n        token,\n        refreshToken\n      } = response.data;\n      localStorage.setItem('accessToken', token);\n      localStorage.setItem('refreshToken', refreshToken);\n      axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      return axiosInstance(originalRequest);\n    } catch (refreshError) {\n      console.error('Refresh token is invalid or expired.');\n      localStorage.removeItem('accessToken');\n      localStorage.removeItem('refreshToken');\n      window.location.href = '/Login';\n    }\n  }\n  return Promise.reject(error);\n});\nexport default axiosInstance;","map":{"version":3,"names":["axios","axiosInstance","create","baseURL","withCredentials","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","response","originalRequest","status","_retry","post","refreshToken","data","setItem","defaults","common","refreshError","console","removeItem","window","location","href"],"sources":["C:/Users/ICT03_01/Documents/FinalProject/front/src/views/login/axiosInstance.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst axiosInstance = axios.create({\r\n  \r\n  baseURL: 'http://localhost:8080/api',\r\n  withCredentials: true\r\n  \r\n});\r\n\r\n\r\naxiosInstance.interceptors.request.use(\r\n    config => {\r\n        const token = localStorage.getItem('accessToken');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    error => Promise.reject(error)\r\n  );\r\n\r\naxiosInstance.interceptors.response.use(\r\n  response => response,\r\n  async error => {\r\n      const originalRequest = error.config;\r\n\r\n      if (error.response.status === 401 && !originalRequest._retry) {\r\n          originalRequest._retry = true;\r\n          try {\r\n              const response = await axiosInstance.post('/refresh-token', {\r\n                  refreshToken: localStorage.getItem('refreshToken'),\r\n              });\r\n\r\n              const { token, refreshToken } = response.data;\r\n              localStorage.setItem('accessToken', token);\r\n              localStorage.setItem('refreshToken', refreshToken);\r\n              axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n\r\n              return axiosInstance(originalRequest);\r\n          } catch (refreshError) {\r\n              console.error('Refresh token is invalid or expired.');\r\n              localStorage.removeItem('accessToken');\r\n              localStorage.removeItem('refreshToken');\r\n              window.location.href = '/Login';\r\n          }\r\n      }\r\n\r\n      return Promise.reject(error);\r\n  }\r\n);\r\n\r\n\r\n\r\nexport default axiosInstance;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,aAAa,GAAGD,KAAK,CAACE,MAAM,CAAC;EAEjCC,OAAO,EAAE,2BAA2B;EACpCC,eAAe,EAAE;AAEnB,CAAC,CAAC;AAGFH,aAAa,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAClCC,MAAM,IAAI;EACN,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;EACjD,IAAIF,KAAK,EAAE;IACPD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAG,UAAUJ,KAAK,EAAE;EACpD;EACA,OAAOD,MAAM;AACjB,CAAC,EACDM,KAAK,IAAIC,OAAO,CAACC,MAAM,CAACF,KAAK,CAC/B,CAAC;AAEHb,aAAa,CAACI,YAAY,CAACY,QAAQ,CAACV,GAAG,CACrCU,QAAQ,IAAIA,QAAQ,EACpB,MAAMH,KAAK,IAAI;EACX,MAAMI,eAAe,GAAGJ,KAAK,CAACN,MAAM;EAEpC,IAAIM,KAAK,CAACG,QAAQ,CAACE,MAAM,KAAK,GAAG,IAAI,CAACD,eAAe,CAACE,MAAM,EAAE;IAC1DF,eAAe,CAACE,MAAM,GAAG,IAAI;IAC7B,IAAI;MACA,MAAMH,QAAQ,GAAG,MAAMhB,aAAa,CAACoB,IAAI,CAAC,gBAAgB,EAAE;QACxDC,YAAY,EAAEZ,YAAY,CAACC,OAAO,CAAC,cAAc;MACrD,CAAC,CAAC;MAEF,MAAM;QAAEF,KAAK;QAAEa;MAAa,CAAC,GAAGL,QAAQ,CAACM,IAAI;MAC7Cb,YAAY,CAACc,OAAO,CAAC,aAAa,EAAEf,KAAK,CAAC;MAC1CC,YAAY,CAACc,OAAO,CAAC,cAAc,EAAEF,YAAY,CAAC;MAClDrB,aAAa,CAACwB,QAAQ,CAACb,OAAO,CAACc,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUjB,KAAK,EAAE;MAE1E,OAAOR,aAAa,CAACiB,eAAe,CAAC;IACzC,CAAC,CAAC,OAAOS,YAAY,EAAE;MACnBC,OAAO,CAACd,KAAK,CAAC,sCAAsC,CAAC;MACrDJ,YAAY,CAACmB,UAAU,CAAC,aAAa,CAAC;MACtCnB,YAAY,CAACmB,UAAU,CAAC,cAAc,CAAC;MACvCC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;IACnC;EACJ;EAEA,OAAOjB,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACF,CAAC;AAID,eAAeb,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}